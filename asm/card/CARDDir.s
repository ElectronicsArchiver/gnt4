.include "macros.inc"

.section .text  # 0x8017C6E0 - 0x8017C944

.global __CARDGetDirBlock
__CARDGetDirBlock:
/* 8017C6E0 001796E0  80 63 00 84 */	lwz r3, 0x84(r3)
/* 8017C6E4 001796E4  4E 80 00 20 */	blr 

.global WriteCallback__
WriteCallback__:
/* 8017C6E8 001796E8  7C 08 02 A6 */	mflr r0
/* 8017C6EC 001796EC  90 01 00 04 */	stw r0, 4(r1)
/* 8017C6F0 001796F0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8017C6F4 001796F4  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8017C6F8 001796F8  93 C1 00 18 */	stw r30, 0x18(r1)
/* 8017C6FC 001796FC  7C 9E 23 79 */	or. r30, r4, r4
/* 8017C700 00179700  93 A1 00 14 */	stw r29, 0x14(r1)
/* 8017C704 00179704  3B A3 00 00 */	addi r29, r3, 0
/* 8017C708 00179708  1C BD 01 10 */	mulli r5, r29, 0x110
/* 8017C70C 0017970C  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C710 00179710  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C714 00179714  7F E0 2A 14 */	add r31, r0, r5
/* 8017C718 00179718  41 80 00 44 */	blt lbl_8017C75C
/* 8017C71C 0017971C  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 8017C720 00179720  80 1F 00 84 */	lwz r0, 0x84(r31)
/* 8017C724 00179724  38 83 20 00 */	addi r4, r3, 0x2000
/* 8017C728 00179728  7C 00 20 40 */	cmplw r0, r4
/* 8017C72C 0017972C  38 03 40 00 */	addi r0, r3, 0x4000
/* 8017C730 00179730  40 82 00 18 */	bne lbl_8017C748
/* 8017C734 00179734  90 1F 00 84 */	stw r0, 0x84(r31)
/* 8017C738 00179738  7C 03 03 78 */	mr r3, r0
/* 8017C73C 0017973C  38 A0 20 00 */	li r5, 0x2000
/* 8017C740 00179740  4B E8 8E 8D */	bl memcpy
/* 8017C744 00179744  48 00 00 18 */	b lbl_8017C75C
lbl_8017C748:
/* 8017C748 00179748  90 9F 00 84 */	stw r4, 0x84(r31)
/* 8017C74C 0017974C  38 64 00 00 */	addi r3, r4, 0
/* 8017C750 00179750  7C 04 03 78 */	mr r4, r0
/* 8017C754 00179754  38 A0 20 00 */	li r5, 0x2000
/* 8017C758 00179758  4B E8 8E 75 */	bl memcpy
lbl_8017C75C:
/* 8017C75C 0017975C  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 8017C760 00179760  28 00 00 00 */	cmplwi r0, 0
/* 8017C764 00179764  40 82 00 10 */	bne lbl_8017C774
/* 8017C768 00179768  38 7F 00 00 */	addi r3, r31, 0
/* 8017C76C 0017976C  38 9E 00 00 */	addi r4, r30, 0
/* 8017C770 00179770  4B FF E2 85 */	bl __CARDPutControlBlock
lbl_8017C774:
/* 8017C774 00179774  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 8017C778 00179778  28 00 00 00 */	cmplwi r0, 0
/* 8017C77C 0017977C  7C 0C 03 78 */	mr r12, r0
/* 8017C780 00179780  41 82 00 1C */	beq lbl_8017C79C
/* 8017C784 00179784  38 00 00 00 */	li r0, 0
/* 8017C788 00179788  7D 88 03 A6 */	mtlr r12
/* 8017C78C 0017978C  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 8017C790 00179790  38 7D 00 00 */	addi r3, r29, 0
/* 8017C794 00179794  38 9E 00 00 */	addi r4, r30, 0
/* 8017C798 00179798  4E 80 00 21 */	blrl 
lbl_8017C79C:
/* 8017C79C 0017979C  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8017C7A0 001797A0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8017C7A4 001797A4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8017C7A8 001797A8  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 8017C7AC 001797AC  38 21 00 20 */	addi r1, r1, 0x20
/* 8017C7B0 001797B0  7C 08 03 A6 */	mtlr r0
/* 8017C7B4 001797B4  4E 80 00 20 */	blr 

.global EraseCallback__
EraseCallback__:
/* 8017C7B8 001797B8  7C 08 02 A6 */	mflr r0
/* 8017C7BC 001797BC  90 01 00 04 */	stw r0, 4(r1)
/* 8017C7C0 001797C0  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 8017C7C4 001797C4  93 E1 00 24 */	stw r31, 0x24(r1)
/* 8017C7C8 001797C8  3B E3 00 00 */	addi r31, r3, 0
/* 8017C7CC 001797CC  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C7D0 001797D0  93 C1 00 20 */	stw r30, 0x20(r1)
/* 8017C7D4 001797D4  1C BF 01 10 */	mulli r5, r31, 0x110
/* 8017C7D8 001797D8  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 8017C7DC 001797DC  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C7E0 001797E0  7C 9D 23 79 */	or. r29, r4, r4
/* 8017C7E4 001797E4  7F C0 2A 14 */	add r30, r0, r5
/* 8017C7E8 001797E8  41 80 00 3C */	blt lbl_8017C824
/* 8017C7EC 001797EC  80 BE 00 84 */	lwz r5, 0x84(r30)
/* 8017C7F0 001797F0  3C 60 80 18 */	lis r3, WriteCallback__@ha
/* 8017C7F4 001797F4  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 8017C7F8 001797F8  38 E3 C6 E8 */	addi r7, r3, WriteCallback__@l
/* 8017C7FC 001797FC  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 8017C800 00179800  7C 00 28 50 */	subf r0, r0, r5
/* 8017C804 00179804  54 00 9B 7E */	srwi r0, r0, 0xd
/* 8017C808 00179808  7C 83 01 D6 */	mullw r4, r3, r0
/* 8017C80C 0017980C  38 C5 00 00 */	addi r6, r5, 0
/* 8017C810 00179810  38 7F 00 00 */	addi r3, r31, 0
/* 8017C814 00179814  38 A0 20 00 */	li r5, 0x2000
/* 8017C818 00179818  4B FF FA 45 */	bl __CARDWrite
/* 8017C81C 0017981C  7C 7D 1B 79 */	or. r29, r3, r3
/* 8017C820 00179820  40 80 00 44 */	bge lbl_8017C864
lbl_8017C824:
/* 8017C824 00179824  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 8017C828 00179828  28 00 00 00 */	cmplwi r0, 0
/* 8017C82C 0017982C  40 82 00 10 */	bne lbl_8017C83C
/* 8017C830 00179830  38 7E 00 00 */	addi r3, r30, 0
/* 8017C834 00179834  38 9D 00 00 */	addi r4, r29, 0
/* 8017C838 00179838  4B FF E1 BD */	bl __CARDPutControlBlock
lbl_8017C83C:
/* 8017C83C 0017983C  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 8017C840 00179840  28 00 00 00 */	cmplwi r0, 0
/* 8017C844 00179844  7C 0C 03 78 */	mr r12, r0
/* 8017C848 00179848  41 82 00 1C */	beq lbl_8017C864
/* 8017C84C 0017984C  38 00 00 00 */	li r0, 0
/* 8017C850 00179850  7D 88 03 A6 */	mtlr r12
/* 8017C854 00179854  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 8017C858 00179858  38 7F 00 00 */	addi r3, r31, 0
/* 8017C85C 0017985C  38 9D 00 00 */	addi r4, r29, 0
/* 8017C860 00179860  4E 80 00 21 */	blrl 
lbl_8017C864:
/* 8017C864 00179864  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 8017C868 00179868  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8017C86C 0017986C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 8017C870 00179870  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 8017C874 00179874  38 21 00 28 */	addi r1, r1, 0x28
/* 8017C878 00179878  7C 08 03 A6 */	mtlr r0
/* 8017C87C 0017987C  4E 80 00 20 */	blr 

.global __CARDUpdateDir
__CARDUpdateDir:
/* 8017C880 00179880  7C 08 02 A6 */	mflr r0
/* 8017C884 00179884  90 01 00 04 */	stw r0, 4(r1)
/* 8017C888 00179888  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 8017C88C 0017988C  93 E1 00 24 */	stw r31, 0x24(r1)
/* 8017C890 00179890  93 C1 00 20 */	stw r30, 0x20(r1)
/* 8017C894 00179894  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 8017C898 00179898  3B A4 00 00 */	addi r29, r4, 0
/* 8017C89C 0017989C  93 81 00 18 */	stw r28, 0x18(r1)
/* 8017C8A0 001798A0  3B 83 00 00 */	addi r28, r3, 0
/* 8017C8A4 001798A4  1C BC 01 10 */	mulli r5, r28, 0x110
/* 8017C8A8 001798A8  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C8AC 001798AC  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C8B0 001798B0  7F C0 2A 14 */	add r30, r0, r5
/* 8017C8B4 001798B4  80 1E 00 00 */	lwz r0, 0(r30)
/* 8017C8B8 001798B8  2C 00 00 00 */	cmpwi r0, 0
/* 8017C8BC 001798BC  40 82 00 0C */	bne lbl_8017C8C8
/* 8017C8C0 001798C0  38 60 FF FD */	li r3, -3
/* 8017C8C4 001798C4  48 00 00 60 */	b lbl_8017C924
lbl_8017C8C8:
/* 8017C8C8 001798C8  83 FE 00 84 */	lwz r31, 0x84(r30)
/* 8017C8CC 001798CC  38 80 1F FC */	li r4, 0x1ffc
/* 8017C8D0 001798D0  A8 BF 1F FA */	lha r5, 0x1ffa(r31)
/* 8017C8D4 001798D4  38 DF 1F C0 */	addi r6, r31, 0x1fc0
/* 8017C8D8 001798D8  38 7F 00 00 */	addi r3, r31, 0
/* 8017C8DC 001798DC  38 05 00 01 */	addi r0, r5, 1
/* 8017C8E0 001798E0  B0 1F 1F FA */	sth r0, 0x1ffa(r31)
/* 8017C8E4 001798E4  38 A6 00 3C */	addi r5, r6, 0x3c
/* 8017C8E8 001798E8  38 C6 00 3E */	addi r6, r6, 0x3e
/* 8017C8EC 001798EC  48 00 00 59 */	bl __CARDCheckSum
/* 8017C8F0 001798F0  38 7F 00 00 */	addi r3, r31, 0
/* 8017C8F4 001798F4  38 80 20 00 */	li r4, 0x2000
/* 8017C8F8 001798F8  4B FE A2 11 */	bl DCStoreRange
/* 8017C8FC 001798FC  93 BE 00 D8 */	stw r29, 0xd8(r30)
/* 8017C900 00179900  3C 60 80 18 */	lis r3, EraseCallback__@ha
/* 8017C904 00179904  38 A3 C7 B8 */	addi r5, r3, EraseCallback__@l
/* 8017C908 00179908  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 8017C90C 0017990C  7F 83 E3 78 */	mr r3, r28
/* 8017C910 00179910  80 9E 00 0C */	lwz r4, 0xc(r30)
/* 8017C914 00179914  7C 00 F8 50 */	subf r0, r0, r31
/* 8017C918 00179918  54 00 9B 7E */	srwi r0, r0, 0xd
/* 8017C91C 0017991C  7C 84 01 D6 */	mullw r4, r4, r0
/* 8017C920 00179920  4B FF DE 21 */	bl __CARDEraseSector
lbl_8017C924:
/* 8017C924 00179924  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 8017C928 00179928  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8017C92C 0017992C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 8017C930 00179930  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 8017C934 00179934  83 81 00 18 */	lwz r28, 0x18(r1)
/* 8017C938 00179938  38 21 00 28 */	addi r1, r1, 0x28
/* 8017C93C 0017993C  7C 08 03 A6 */	mtlr r0
/* 8017C940 00179940  4E 80 00 20 */	blr 
