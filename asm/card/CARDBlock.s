.include "macros.inc"

.section .text  # 0x8017C2DC - 0x8017C6E0

.global __CARDGetFatBlock
__CARDGetFatBlock:
/* 8017C2DC 001792DC  80 63 00 88 */	lwz r3, 0x88(r3)
/* 8017C2E0 001792E0  4E 80 00 20 */	blr 

.global WriteCallback_
WriteCallback_:
/* 8017C2E4 001792E4  7C 08 02 A6 */	mflr r0
/* 8017C2E8 001792E8  90 01 00 04 */	stw r0, 4(r1)
/* 8017C2EC 001792EC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8017C2F0 001792F0  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8017C2F4 001792F4  93 C1 00 18 */	stw r30, 0x18(r1)
/* 8017C2F8 001792F8  7C 9E 23 79 */	or. r30, r4, r4
/* 8017C2FC 001792FC  93 A1 00 14 */	stw r29, 0x14(r1)
/* 8017C300 00179300  3B A3 00 00 */	addi r29, r3, 0
/* 8017C304 00179304  1C BD 01 10 */	mulli r5, r29, 0x110
/* 8017C308 00179308  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C30C 0017930C  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C310 00179310  7F E0 2A 14 */	add r31, r0, r5
/* 8017C314 00179314  41 80 00 48 */	blt lbl_8017C35C
/* 8017C318 00179318  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 8017C31C 0017931C  80 1F 00 88 */	lwz r0, 0x88(r31)
/* 8017C320 00179320  38 83 60 00 */	addi r4, r3, 0x6000
/* 8017C324 00179324  7C 00 20 40 */	cmplw r0, r4
/* 8017C328 00179328  3C A3 00 01 */	addis r5, r3, 1
/* 8017C32C 0017932C  38 A5 80 00 */	addi r5, r5, -32768
/* 8017C330 00179330  40 82 00 18 */	bne lbl_8017C348
/* 8017C334 00179334  90 BF 00 88 */	stw r5, 0x88(r31)
/* 8017C338 00179338  38 65 00 00 */	addi r3, r5, 0
/* 8017C33C 0017933C  38 A0 20 00 */	li r5, 0x2000
/* 8017C340 00179340  4B E8 92 8D */	bl memcpy
/* 8017C344 00179344  48 00 00 18 */	b lbl_8017C35C
lbl_8017C348:
/* 8017C348 00179348  90 9F 00 88 */	stw r4, 0x88(r31)
/* 8017C34C 0017934C  38 64 00 00 */	addi r3, r4, 0
/* 8017C350 00179350  38 85 00 00 */	addi r4, r5, 0
/* 8017C354 00179354  38 A0 20 00 */	li r5, 0x2000
/* 8017C358 00179358  4B E8 92 75 */	bl memcpy
lbl_8017C35C:
/* 8017C35C 0017935C  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 8017C360 00179360  28 00 00 00 */	cmplwi r0, 0
/* 8017C364 00179364  40 82 00 10 */	bne lbl_8017C374
/* 8017C368 00179368  38 7F 00 00 */	addi r3, r31, 0
/* 8017C36C 0017936C  38 9E 00 00 */	addi r4, r30, 0
/* 8017C370 00179370  4B FF E6 85 */	bl __CARDPutControlBlock
lbl_8017C374:
/* 8017C374 00179374  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 8017C378 00179378  28 00 00 00 */	cmplwi r0, 0
/* 8017C37C 0017937C  7C 0C 03 78 */	mr r12, r0
/* 8017C380 00179380  41 82 00 1C */	beq lbl_8017C39C
/* 8017C384 00179384  38 00 00 00 */	li r0, 0
/* 8017C388 00179388  7D 88 03 A6 */	mtlr r12
/* 8017C38C 0017938C  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 8017C390 00179390  38 7D 00 00 */	addi r3, r29, 0
/* 8017C394 00179394  38 9E 00 00 */	addi r4, r30, 0
/* 8017C398 00179398  4E 80 00 21 */	blrl 
lbl_8017C39C:
/* 8017C39C 0017939C  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8017C3A0 001793A0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8017C3A4 001793A4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8017C3A8 001793A8  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 8017C3AC 001793AC  38 21 00 20 */	addi r1, r1, 0x20
/* 8017C3B0 001793B0  7C 08 03 A6 */	mtlr r0
/* 8017C3B4 001793B4  4E 80 00 20 */	blr 

.global EraseCallback_
EraseCallback_:
/* 8017C3B8 001793B8  7C 08 02 A6 */	mflr r0
/* 8017C3BC 001793BC  90 01 00 04 */	stw r0, 4(r1)
/* 8017C3C0 001793C0  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 8017C3C4 001793C4  93 E1 00 24 */	stw r31, 0x24(r1)
/* 8017C3C8 001793C8  3B E3 00 00 */	addi r31, r3, 0
/* 8017C3CC 001793CC  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C3D0 001793D0  93 C1 00 20 */	stw r30, 0x20(r1)
/* 8017C3D4 001793D4  1C BF 01 10 */	mulli r5, r31, 0x110
/* 8017C3D8 001793D8  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 8017C3DC 001793DC  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C3E0 001793E0  7C 9D 23 79 */	or. r29, r4, r4
/* 8017C3E4 001793E4  7F C0 2A 14 */	add r30, r0, r5
/* 8017C3E8 001793E8  41 80 00 3C */	blt lbl_8017C424
/* 8017C3EC 001793EC  80 BE 00 88 */	lwz r5, 0x88(r30)
/* 8017C3F0 001793F0  3C 60 80 18 */	lis r3, WriteCallback_@ha
/* 8017C3F4 001793F4  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 8017C3F8 001793F8  38 E3 C2 E4 */	addi r7, r3, WriteCallback_@l
/* 8017C3FC 001793FC  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 8017C400 00179400  7C 00 28 50 */	subf r0, r0, r5
/* 8017C404 00179404  54 00 9B 7E */	srwi r0, r0, 0xd
/* 8017C408 00179408  7C 83 01 D6 */	mullw r4, r3, r0
/* 8017C40C 0017940C  38 C5 00 00 */	addi r6, r5, 0
/* 8017C410 00179410  38 7F 00 00 */	addi r3, r31, 0
/* 8017C414 00179414  38 A0 20 00 */	li r5, 0x2000
/* 8017C418 00179418  4B FF FE 45 */	bl __CARDWrite
/* 8017C41C 0017941C  7C 7D 1B 79 */	or. r29, r3, r3
/* 8017C420 00179420  40 80 00 44 */	bge lbl_8017C464
lbl_8017C424:
/* 8017C424 00179424  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 8017C428 00179428  28 00 00 00 */	cmplwi r0, 0
/* 8017C42C 0017942C  40 82 00 10 */	bne lbl_8017C43C
/* 8017C430 00179430  38 7E 00 00 */	addi r3, r30, 0
/* 8017C434 00179434  38 9D 00 00 */	addi r4, r29, 0
/* 8017C438 00179438  4B FF E5 BD */	bl __CARDPutControlBlock
lbl_8017C43C:
/* 8017C43C 0017943C  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 8017C440 00179440  28 00 00 00 */	cmplwi r0, 0
/* 8017C444 00179444  7C 0C 03 78 */	mr r12, r0
/* 8017C448 00179448  41 82 00 1C */	beq lbl_8017C464
/* 8017C44C 0017944C  38 00 00 00 */	li r0, 0
/* 8017C450 00179450  7D 88 03 A6 */	mtlr r12
/* 8017C454 00179454  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 8017C458 00179458  38 7F 00 00 */	addi r3, r31, 0
/* 8017C45C 0017945C  38 9D 00 00 */	addi r4, r29, 0
/* 8017C460 00179460  4E 80 00 21 */	blrl 
lbl_8017C464:
/* 8017C464 00179464  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 8017C468 00179468  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8017C46C 0017946C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 8017C470 00179470  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 8017C474 00179474  38 21 00 28 */	addi r1, r1, 0x28
/* 8017C478 00179478  7C 08 03 A6 */	mtlr r0
/* 8017C47C 0017947C  4E 80 00 20 */	blr 

.global __CARDAllocBlock
__CARDAllocBlock:
/* 8017C480 00179480  7C 08 02 A6 */	mflr r0
/* 8017C484 00179484  1C E3 01 10 */	mulli r7, r3, 0x110
/* 8017C488 00179488  90 01 00 04 */	stw r0, 4(r1)
/* 8017C48C 0017948C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8017C490 00179490  3C C0 80 24 */	lis r6, lbl_80245540@ha
/* 8017C494 00179494  38 06 55 40 */	addi r0, r6, lbl_80245540@l
/* 8017C498 00179498  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8017C49C 0017949C  7D 20 3A 14 */	add r9, r0, r7
/* 8017C4A0 001794A0  93 C1 00 18 */	stw r30, 0x18(r1)
/* 8017C4A4 001794A4  80 09 00 00 */	lwz r0, 0(r9)
/* 8017C4A8 001794A8  2C 00 00 00 */	cmpwi r0, 0
/* 8017C4AC 001794AC  40 82 00 0C */	bne lbl_8017C4B8
/* 8017C4B0 001794B0  38 60 FF FD */	li r3, -3
/* 8017C4B4 001794B4  48 00 00 CC */	b lbl_8017C580
lbl_8017C4B8:
/* 8017C4B8 001794B8  81 09 00 88 */	lwz r8, 0x88(r9)
/* 8017C4BC 001794BC  A0 08 00 06 */	lhz r0, 6(r8)
/* 8017C4C0 001794C0  7C 00 20 40 */	cmplw r0, r4
/* 8017C4C4 001794C4  40 80 00 0C */	bge lbl_8017C4D0
/* 8017C4C8 001794C8  38 60 FF F7 */	li r3, -9
/* 8017C4CC 001794CC  48 00 00 B4 */	b lbl_8017C580
lbl_8017C4D0:
/* 8017C4D0 001794D0  7C 04 00 50 */	subf r0, r4, r0
/* 8017C4D4 001794D4  B0 08 00 06 */	sth r0, 6(r8)
/* 8017C4D8 001794D8  3C C0 00 01 */	lis r6, 0x0000FFFF@ha
/* 8017C4DC 001794DC  39 86 FF FF */	addi r12, r6, 0x0000FFFF@l
/* 8017C4E0 001794E0  A1 68 00 08 */	lhz r11, 8(r8)
/* 8017C4E4 001794E4  38 0C 00 00 */	addi r0, r12, 0
/* 8017C4E8 001794E8  3B C0 00 00 */	li r30, 0
/* 8017C4EC 001794EC  48 00 00 7C */	b lbl_8017C568
lbl_8017C4F0:
/* 8017C4F0 001794F0  A1 49 00 10 */	lhz r10, 0x10(r9)
/* 8017C4F4 001794F4  3B DE 00 01 */	addi r30, r30, 1
/* 8017C4F8 001794F8  57 C6 04 3E */	clrlwi r6, r30, 0x10
/* 8017C4FC 001794FC  38 EA FF FB */	addi r7, r10, -5
/* 8017C500 00179500  7C 07 30 00 */	cmpw r7, r6
/* 8017C504 00179504  40 80 00 0C */	bge lbl_8017C510
/* 8017C508 00179508  38 60 FF FA */	li r3, -6
/* 8017C50C 0017950C  48 00 00 74 */	b lbl_8017C580
lbl_8017C510:
/* 8017C510 00179510  39 6B 00 01 */	addi r11, r11, 1
/* 8017C514 00179514  55 66 04 3E */	clrlwi r6, r11, 0x10
/* 8017C518 00179518  28 06 00 05 */	cmplwi r6, 5
/* 8017C51C 0017951C  41 80 00 0C */	blt lbl_8017C528
/* 8017C520 00179520  7C 06 50 40 */	cmplw r6, r10
/* 8017C524 00179524  41 80 00 08 */	blt lbl_8017C52C
lbl_8017C528:
/* 8017C528 00179528  39 60 00 05 */	li r11, 5
lbl_8017C52C:
/* 8017C52C 0017952C  55 66 0B FC */	rlwinm r6, r11, 1, 0xf, 0x1e
/* 8017C530 00179530  7C E8 32 14 */	add r7, r8, r6
/* 8017C534 00179534  A0 C7 00 00 */	lhz r6, 0(r7)
/* 8017C538 00179538  28 06 00 00 */	cmplwi r6, 0
/* 8017C53C 0017953C  40 82 00 2C */	bne lbl_8017C568
/* 8017C540 00179540  55 86 04 3E */	clrlwi r6, r12, 0x10
/* 8017C544 00179544  28 06 FF FF */	cmplwi r6, 0xffff
/* 8017C548 00179548  40 82 00 0C */	bne lbl_8017C554
/* 8017C54C 0017954C  7D 6C 5B 78 */	mr r12, r11
/* 8017C550 00179550  48 00 00 0C */	b lbl_8017C55C
lbl_8017C554:
/* 8017C554 00179554  57 E6 0B FC */	rlwinm r6, r31, 1, 0xf, 0x1e
/* 8017C558 00179558  7D 68 33 2E */	sthx r11, r8, r6
lbl_8017C55C:
/* 8017C55C 0017955C  B0 07 00 00 */	sth r0, 0(r7)
/* 8017C560 00179560  3B EB 00 00 */	addi r31, r11, 0
/* 8017C564 00179564  38 84 FF FF */	addi r4, r4, -1
lbl_8017C568:
/* 8017C568 00179568  28 04 00 00 */	cmplwi r4, 0
/* 8017C56C 0017956C  40 82 FF 84 */	bne lbl_8017C4F0
/* 8017C570 00179570  B1 68 00 08 */	sth r11, 8(r8)
/* 8017C574 00179574  7D 04 43 78 */	mr r4, r8
/* 8017C578 00179578  B1 89 00 BE */	sth r12, 0xbe(r9)
/* 8017C57C 0017957C  48 00 00 B9 */	bl __CARDUpdateFatBlock
lbl_8017C580:
/* 8017C580 00179580  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8017C584 00179584  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8017C588 00179588  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8017C58C 0017958C  38 21 00 20 */	addi r1, r1, 0x20
/* 8017C590 00179590  7C 08 03 A6 */	mtlr r0
/* 8017C594 00179594  4E 80 00 20 */	blr 

.global __CARDFreeBlock
__CARDFreeBlock:
/* 8017C598 00179598  7C 08 02 A6 */	mflr r0
/* 8017C59C 0017959C  1C E3 01 10 */	mulli r7, r3, 0x110
/* 8017C5A0 001795A0  90 01 00 04 */	stw r0, 4(r1)
/* 8017C5A4 001795A4  3C C0 80 24 */	lis r6, lbl_80245540@ha
/* 8017C5A8 001795A8  94 21 FF F8 */	stwu r1, -8(r1)
/* 8017C5AC 001795AC  38 06 55 40 */	addi r0, r6, lbl_80245540@l
/* 8017C5B0 001795B0  7D 20 3A 14 */	add r9, r0, r7
/* 8017C5B4 001795B4  80 09 00 00 */	lwz r0, 0(r9)
/* 8017C5B8 001795B8  2C 00 00 00 */	cmpwi r0, 0
/* 8017C5BC 001795BC  40 82 00 0C */	bne lbl_8017C5C8
/* 8017C5C0 001795C0  38 60 FF FD */	li r3, -3
/* 8017C5C4 001795C4  48 00 00 60 */	b lbl_8017C624
lbl_8017C5C8:
/* 8017C5C8 001795C8  81 09 00 88 */	lwz r8, 0x88(r9)
/* 8017C5CC 001795CC  38 E0 00 00 */	li r7, 0
/* 8017C5D0 001795D0  48 00 00 40 */	b lbl_8017C610
lbl_8017C5D4:
/* 8017C5D4 001795D4  54 84 04 3E */	clrlwi r4, r4, 0x10
/* 8017C5D8 001795D8  28 04 00 05 */	cmplwi r4, 5
/* 8017C5DC 001795DC  41 80 00 10 */	blt lbl_8017C5EC
/* 8017C5E0 001795E0  A0 09 00 10 */	lhz r0, 0x10(r9)
/* 8017C5E4 001795E4  7C 04 00 40 */	cmplw r4, r0
/* 8017C5E8 001795E8  41 80 00 0C */	blt lbl_8017C5F4
lbl_8017C5EC:
/* 8017C5EC 001795EC  38 60 FF FA */	li r3, -6
/* 8017C5F0 001795F0  48 00 00 34 */	b lbl_8017C624
lbl_8017C5F4:
/* 8017C5F4 001795F4  54 80 08 3C */	slwi r0, r4, 1
/* 8017C5F8 001795F8  7C C8 02 14 */	add r6, r8, r0
/* 8017C5FC 001795FC  A0 86 00 00 */	lhz r4, 0(r6)
/* 8017C600 00179600  B0 E6 00 00 */	sth r7, 0(r6)
/* 8017C604 00179604  A0 C8 00 06 */	lhz r6, 6(r8)
/* 8017C608 00179608  38 06 00 01 */	addi r0, r6, 1
/* 8017C60C 0017960C  B0 08 00 06 */	sth r0, 6(r8)
lbl_8017C610:
/* 8017C610 00179610  54 80 04 3E */	clrlwi r0, r4, 0x10
/* 8017C614 00179614  28 00 FF FF */	cmplwi r0, 0xffff
/* 8017C618 00179618  40 82 FF BC */	bne lbl_8017C5D4
/* 8017C61C 0017961C  7D 04 43 78 */	mr r4, r8
/* 8017C620 00179620  48 00 00 15 */	bl __CARDUpdateFatBlock
lbl_8017C624:
/* 8017C624 00179624  80 01 00 0C */	lwz r0, 0xc(r1)
/* 8017C628 00179628  38 21 00 08 */	addi r1, r1, 8
/* 8017C62C 0017962C  7C 08 03 A6 */	mtlr r0
/* 8017C630 00179630  4E 80 00 20 */	blr 

.global __CARDUpdateFatBlock
__CARDUpdateFatBlock:
/* 8017C634 00179634  7C 08 02 A6 */	mflr r0
/* 8017C638 00179638  90 01 00 04 */	stw r0, 4(r1)
/* 8017C63C 0017963C  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 8017C640 00179640  93 E1 00 24 */	stw r31, 0x24(r1)
/* 8017C644 00179644  93 C1 00 20 */	stw r30, 0x20(r1)
/* 8017C648 00179648  3B C5 00 00 */	addi r30, r5, 0
/* 8017C64C 0017964C  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 8017C650 00179650  3B A4 00 00 */	addi r29, r4, 0
/* 8017C654 00179654  38 BD 00 00 */	addi r5, r29, 0
/* 8017C658 00179658  93 81 00 18 */	stw r28, 0x18(r1)
/* 8017C65C 0017965C  3B 83 00 00 */	addi r28, r3, 0
/* 8017C660 00179660  38 DD 00 02 */	addi r6, r29, 2
/* 8017C664 00179664  A0 64 00 04 */	lhz r3, 4(r4)
/* 8017C668 00179668  1C 9C 01 10 */	mulli r4, r28, 0x110
/* 8017C66C 0017966C  38 03 00 01 */	addi r0, r3, 1
/* 8017C670 00179670  3C 60 80 24 */	lis r3, lbl_80245540@ha
/* 8017C674 00179674  B0 1D 00 04 */	sth r0, 4(r29)
/* 8017C678 00179678  38 03 55 40 */	addi r0, r3, lbl_80245540@l
/* 8017C67C 0017967C  7F E0 22 14 */	add r31, r0, r4
/* 8017C680 00179680  38 7D 00 04 */	addi r3, r29, 4
/* 8017C684 00179684  38 80 1F FC */	li r4, 0x1ffc
/* 8017C688 00179688  48 00 02 BD */	bl __CARDCheckSum
/* 8017C68C 0017968C  38 7D 00 00 */	addi r3, r29, 0
/* 8017C690 00179690  38 80 20 00 */	li r4, 0x2000
/* 8017C694 00179694  4B FE A4 75 */	bl DCStoreRange
/* 8017C698 00179698  93 DF 00 D8 */	stw r30, 0xd8(r31)
/* 8017C69C 0017969C  3C 60 80 18 */	lis r3, EraseCallback_@ha
/* 8017C6A0 001796A0  38 A3 C3 B8 */	addi r5, r3, EraseCallback_@l
/* 8017C6A4 001796A4  80 1F 00 80 */	lwz r0, 0x80(r31)
/* 8017C6A8 001796A8  7F 83 E3 78 */	mr r3, r28
/* 8017C6AC 001796AC  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 8017C6B0 001796B0  7C 00 E8 50 */	subf r0, r0, r29
/* 8017C6B4 001796B4  54 00 9B 7E */	srwi r0, r0, 0xd
/* 8017C6B8 001796B8  7C 84 01 D6 */	mullw r4, r4, r0
/* 8017C6BC 001796BC  4B FF E0 85 */	bl __CARDEraseSector
/* 8017C6C0 001796C0  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 8017C6C4 001796C4  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8017C6C8 001796C8  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 8017C6CC 001796CC  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 8017C6D0 001796D0  83 81 00 18 */	lwz r28, 0x18(r1)
/* 8017C6D4 001796D4  38 21 00 28 */	addi r1, r1, 0x28
/* 8017C6D8 001796D8  7C 08 03 A6 */	mtlr r0
/* 8017C6DC 001796DC  4E 80 00 20 */	blr 
